/* ----------------------------- */
/* Base Settings (Smartphone/Tablet) */
/* ----------------------------- */
html, body {
  height: 100vh;
  margin: 0;
  padding: 0;
  overflow: hidden; /* 不要なスクロールを防止 */
  background-color: #FFFFDD;
}

/* CSS変数による調整用設定 */
:root {
  /* 拡大縮小倍率と盤面の座標オフセット */
  --scale-factor: 0.995;           /* ここで n 倍に調整可能（例：2 にすると 2 倍） */
  --board-offset-x: -1.5px;           /* 水平方向の調整 */
  --board-offset-y: -121.5px;       /* 垂直方向の調整 */
  
  --host-icon-height: calc(30px * var(--scale-factor));
  --host-twitter-font-size: calc(30px * var(--scale-factor));
  --title-font-size: calc(100px * var(--scale-factor));
  --title-line-height: 1.2;
  
  /* 盤面のサイズは画面幅に倍率を掛けたサイズ */
  --board-width: calc(100vw * var(--scale-factor));
  --board-height: calc(100vw * var(--scale-factor));
  --cell-size: calc((100vw * var(--scale-factor)) / 9);
  --piece-width: calc(var(--cell-size) * 0.9);
  --piece-height: calc(var(--cell-size) * 0.9);
  --piece-font-size: calc(var(--piece-height) * 0.5);
  --captured-area-height: calc(50px * var(--scale-factor));
  --header-bottom-margin: calc(10px * var(--scale-factor));
  
  /* 持ち駒の位置調整用変数 */
  --top-hand-top: calc(-98px * var(--scale-factor));
  --top-hand-right: calc(-190px * var(--scale-factor));
  --top-hand-width: calc(1000px * var(--scale-factor));
  --top-hand-height: calc(100px * var(--scale-factor));
  
  --bottom-hand-top: calc(101vw * var(--scale-factor));
  --bottom-hand-left: calc(4px * var(--scale-factor));
  --bottom-hand-width: calc(100vw * var(--scale-factor));
  --bottom-hand-height: calc(50px * var(--scale-factor));
  
  /* タイマー配置・背景調整用変数 */
  --sente-timer-offset-y: calc(-0.9 * var(--cell-size));  /* 先手タイマー縦位置 */
  --gote-timer-offset-y: calc(-0.9 * var(--cell-size));   /* 後手タイマー縦位置 */
  --sente-timer-offset-x: 0; /* 先手タイマー水平調整 */
  --gote-timer-offset-x: 0;  /* 後手タイマー水平調整 */
  
  --timer-padding-vertical: 2px;    /* タイマー背景上下の余白 */
  --timer-padding-horizontal: 8px;  /* タイマー背景左右の余白 */
  
  /* 反転後の座標調整用変数 */
  --flip-offset-x: 0px;
  --flip-offset-y: 243px;
}

/* ----------------------------- */
/* 全体のゲームUIラッパー（振りごま結果で上下反転） */
/* ----------------------------- */
#game-wrapper.flipped {
  transform: rotate(180deg) translate(var(--flip-offset-x), var(--flip-offset-y));
}

/* ----------------------------- */
/* Board and Captured Pieces Layout */
/* ----------------------------- */
#board-container {
  width: var(--board-width);
  height: var(--board-height);
  margin: calc(230px * var(--scale-factor)) auto 0 auto;
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
  /* 座標調整：指定したオフセット値分ずらす */
  transform: translate(var(--board-offset-x), var(--board-offset-y));
}

#shogi-board {
  display: grid;
  grid-template-columns: repeat(9, var(--cell-size));
  grid-template-rows: repeat(9, var(--cell-size));
  border: calc(2px * var(--scale-factor)) solid black;
  width: var(--board-width);
  height: var(--board-height);
}

/* ----------------------------- */
/* 持ち駒エリア */
/* ----------------------------- */
#top-hand-container {
  position: absolute;
  top: var(--top-hand-top);
  left: var(--top-hand-right);
  width: var(--top-hand-width);
  height: var(--top-hand-height);
  z-index: 1000;
}

#top-hand {
  display: flex;
  flex-direction: row-reverse;
  align-items: center;
  justify-content: flex-start;
  width: 100%;
  height: 100%;
  gap: calc(5px * var(--scale-factor));
  overflow-x: auto;
}

#bottom-hand-container {
  position: absolute;
  top: var(--bottom-hand-top);
  left: var(--bottom-hand-left);
  width: var(--bottom-hand-width);
  height: var(--bottom-hand-height);
  z-index: 200;
}

#bottom-hand {
  display: flex;
  flex-direction: row;
  align-items: center;
  justify-content: flex-start;
  gap: calc(5px * var(--scale-factor));
  overflow-x: auto;
}

/* ----------------------------- */
/* Board Cells and Pieces */
/* ----------------------------- */
.cell {
  width: var(--cell-size);
  height: var(--cell-size);
  border: calc(1px * var(--scale-factor)) solid black;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: calc(20px * var(--scale-factor));
  font-weight: bold;
  cursor: pointer;
  background-color: #FFCC66;
}

.piece {
  background-color: #CD853F;
  border: calc(1px * var(--scale-factor)) solid rgba(0, 0, 0, 0.1);
  width: var(--piece-width);
  height: var(--piece-height);
  position: relative;
  overflow: visible;
  clip-path: polygon(50% 0%, 85% 15%, 96% 98%, 4% 98%, 15% 15%);
  display: flex;
  align-items: center;
  justify-content: center;
  user-select: none;
  font-family: 'Shippori Mincho', serif;
  font-size: var(--piece-font-size);
}

/* ----------------------------- */
/* 持ち駒・成り駒などの追加スタイル */
/* ----------------------------- */
.promoted {
  color: red;
}

.selected-hand {
  outline: 2px solid blue;
}

/* 成香、成桂、成銀専用：縦書きと文字サイズ */
.small-promoted {
  font-size: 1.8em;
  writing-mode: vertical-rl;
  text-orientation: upright;
}

/* ----------------------------- */
/* タイマー用スタイル */
/* ----------------------------- */
.timer {
  position: absolute;
  font-family: 'Shippori Mincho', serif;
  font-weight: bold;
  font-size: calc(20px * var(--scale-factor));
  color: black;
  background-color: rgba(255, 255, 255, 0.8);
  padding: var(--timer-padding-vertical) var(--timer-padding-horizontal);
  border-radius: 2px;
  z-index: 3000;
}

/* タイマー（残り3分以下なら赤く） */
.timer.red {
  color: red;
}

/* タイマーの配置：先手・後手ラベルの直下、位置調整可能 */
#sente-timer {
  bottom: calc(var(--sente-timer-offset-y));
  right: var(--sente-timer-offset-x);
}
#gote-timer {
  top: calc(var(--gote-timer-offset-y));
  left: var(--gote-timer-offset-x);
  transform: rotate(180deg); /* 後手タイマーは逆さま */
}

/* ----------------------------- */
/* 初期配置ラベル */
/* ----------------------------- */
.side-label {
  position: absolute;
  font-family: 'Shippori Mincho', serif;
  font-weight: bold;
  font-size: calc(30px * var(--scale-factor));
  z-index: 3000;
}

.gote-label {
  top: calc(-0.5 * var(--cell-size));
  left: 0;
  transform: rotate(180deg);
}

.sente-label {
  bottom: calc(-0.5 * var(--cell-size));
  right: 0;
}

.piece .piece-count {
  position: absolute;
  bottom: calc(-5px * var(--scale-factor));
  right: 0;
  color: black;
  font-size: calc(25px * var(--scale-factor));
  padding: 0 calc(7px * var(--scale-factor));
  border-radius: calc(5px * var(--scale-factor));
}

.rotated {
  transform: rotate(180deg);
}

/* ----------------------------- */
/* 振り駒用スタイル */
/* ----------------------------- */
#furikoma-container {
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  z-index: 5000;
  background-color: #FFFFDD;
  padding: calc(20px * var(--scale-factor));
  border: calc(2px * var(--scale-factor)) solid black;
  border-radius: calc(10px * var(--scale-factor));
}

#furikoma-pieces {
  display: flex;
  gap: calc(10px * var(--scale-factor));
  margin-bottom: calc(20px * var(--scale-factor));
}

#toss-button {
  font-size: calc(20px * var(--scale-factor));
  padding: calc(10px * var(--scale-factor)) calc(20px * var(--scale-factor));
  cursor: pointer;
}
